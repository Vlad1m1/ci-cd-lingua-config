---
  openapi: "3.0.0"
  info: 
    title: "ForeignLang"
    description: "This service defines the main API methods"
    version: "1.0.0"
    contact: 
      name: "Dmitriy Prokhorov"
      email: "dmitriy.prokhorov.04@gmail.com"
  host: "localhost:8080"
  basePath: "/"
  produces: 
    - "application/json"
  schemes: 
    - "http"
  securityDefinitions: 
    JWT: 
      type: "apiKey"
      in: "header"
      name: "Authorization"
      description: ""
  components: 
    securitySchemes: 
      JWT: 
        type: "http"
        scheme: "bearer"
        bearerFormat: "JWT"
        description: "Input your JWT as: Bearer <token>"
    schemas: 
      AuthResponseDTO: 
        type: "object"
        required: 
          - "accessToken"
          - "user"
        properties: 
          accessToken: 
            type: "string"
            description: "JWT access token for authentication"
            example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          user: 
            $ref: "#/components/schemas/UserDTO"
        description: "Response after successful authentication"
      ErrorResponse: 
        type: "object"
        required: 
          - "code"
          - "type"
          - "message"
        properties: 
          code: 
            type: "integer"
            description: "HTTP status code"
            example: 404
          type: 
            type: "string"
            description: "Error type identifier"
            example: "QUEST_NOT_FOUND"
          message: 
            type: "string"
            description: "Human-readable error message"
            example: "Quest not found."
      UserShortDTO: 
        type: "object"
        required: 
          - "id"
          - "username"
          - "stars"
          - "exp"
        properties: 
          id: 
            type: "number"
            description: "User ID"
            example: 1
          username: 
            type: "string"
            description: "Username"
            example: "john_doe"
          firstName: 
            type: "string"
            nullable: true
            description: "User's first name"
            example: "John"
          lastName: 
            type: "string"
            nullable: true
            description: "User's last name"
            example: "Doe"
          photoUrl: 
            type: "string"
            nullable: true
            description: "URL to user's photo"
            example: "https://example.com/photo.jpg"
          stars: 
            type: "number"
            description: "Number of stars earned"
            example: 150
          exp: 
            type: "number"
            description: "Experience points"
            example: 500
      FriendDTO: 
        type: "object"
        required: 
          - "id"
          - "username"
          - "stars"
          - "exp"
          - "friendsSince"
        properties: 
          id: 
            type: "integer"
            description: "Friend's user ID"
            example: 2
          username: 
            type: "string"
            description: "Friend's username"
            example: "jane_doe"
          firstName: 
            type: "string"
            nullable: true
            description: "Friend's first name"
            example: "Jane"
          lastName: 
            type: "string"
            nullable: true
            description: "Friend's last name"
            example: "Doe"
          photoUrl: 
            type: "string"
            nullable: true
            description: "URL to friend's photo"
            example: "https://example.com/photo.jpg"
          stars: 
            type: "integer"
            description: "Friend's stars count"
            example: 50
          exp: 
            type: "integer"
            description: "Friend's experience points"
            example: 200
          friendsSince: 
            type: "string"
            format: "date-time"
            description: "Date when friendship was established"
            example: "2024-01-01T00:00:00.000Z"
        allOf: 
          - 
            $ref: "#/components/schemas/UserShortDTO"
          - 
            type: "object"
            properties: 
              friendsSince: 
                type: "string"
                format: "date-time"
                example: "2024-01-15T10:30:00.000Z"
      FriendRequestDTO: 
        type: "object"
        required: 
          - "id"
          - "requesterId"
          - "addresseeId"
          - "status"
          - "createdAt"
        properties: 
          id: 
            type: "number"
            description: "Friend request ID"
            example: 1
          requesterId: 
            type: "number"
            description: "ID of user who sent the request"
            example: 1
          addresseeId: 
            type: "number"
            description: "ID of user who received the request"
            example: 2
          status: 
            type: "string"
            enum: 
              - "PENDING"
              - "ACCEPTED"
              - "REJECTED"
              - "CANCELED"
            description: "Request status"
            example: "PENDING"
          createdAt: 
            type: "string"
            format: "date-time"
            description: "Request creation date"
            example: "2024-01-15T10:30:00.000Z"
          respondedAt: 
            type: "string"
            format: "date-time"
            nullable: true
            description: "Response date (null if pending)"
            example: null
          requester: 
            $ref: "#/components/schemas/UserShortDTO"
          addressee: 
            $ref: "#/components/schemas/UserShortDTO"
      SendFriendRequestInput: 
        type: "object"
        required: 
          - "addresseeId"
        properties: 
          addresseeId: 
            type: "integer"
            description: "ID of the user to send friend request to"
            example: 2
      RespondToFriendRequestInput: 
        type: "object"
        required: 
          - "accept"
        properties: 
          accept: 
            type: "boolean"
            description: "Whether to accept (true) or reject (false) the request"
            example: true
      LanguageDTO: 
        type: "object"
        required: 
          - "id"
          - "name"
        properties: 
          id: 
            type: "integer"
            description: "Language ID"
            example: 1
          name: 
            type: "string"
            description: "Language name"
            example: "English"
          icon: 
            type: "string"
            description: "Language icon (emoji or URL)"
            example: "üá¨üáß"
      CreateLanguageInput: 
        type: "object"
        required: 
          - "name"
        properties: 
          name: 
            type: "string"
            description: "Language name"
            example: "German"
          icon: 
            type: "string"
            description: "Language icon (emoji or URL)"
            example: "üá©üá™"
      UpdateLanguageInput: 
        type: "object"
        properties: 
          name: 
            type: "string"
            description: "Language name"
            example: "Spanish"
          icon: 
            type: "string"
            description: "Language icon (emoji or URL)"
            example: "üá™üá∏"
      SetUserLanguageInput: 
        type: "object"
        required: 
          - "languageId"
        properties: 
          languageId: 
            type: "integer"
            description: "Language ID to set for user"
            example: 1
      ModuleDTO: 
        type: "object"
        required: 
          - "id"
          - "languageId"
          - "name"
        properties: 
          id: 
            type: "integer"
            description: "Module ID"
            example: 1
          languageId: 
            type: "integer"
            description: "Language ID this module belongs to"
            example: 1
          name: 
            type: "string"
            description: "Module name"
            example: "Beginner"
          icon: 
            type: "string"
            description: "Module icon (emoji or URL)"
            example: "üìö"
      LevelDTO: 
        type: "object"
        required: 
          - "id"
          - "moduleId"
          - "name"
          - "questsCount"
        properties: 
          id: 
            type: "integer"
            description: "Level ID"
            example: 1
          moduleId: 
            type: "integer"
            description: "Module ID this level belongs to"
            example: 1
          name: 
            type: "string"
            description: "Level name"
            example: "Greetings"
          questsCount: 
            type: "integer"
            description: "Number of quests in this level"
            example: 10
      LevelProgressDTO: 
        type: "object"
        required: 
          - "questsCompleted"
          - "score"
          - "stars"
        properties: 
          questsCompleted: 
            type: "integer"
            description: "Number of quests completed by user"
            example: 5
          score: 
            type: "integer"
            description: "Number of correct answers"
            example: 4
          stars: 
            type: "integer"
            description: "Stars earned (equal to score)"
            example: 4
      LevelWithProgressDTO: 
        allOf: 
          - 
            $ref: "#/components/schemas/LevelDTO"
          - 
            type: "object"
            properties: 
              userProgress: 
                $ref: "#/components/schemas/LevelProgressDTO"
      ModuleWithLevelsDTO: 
        allOf: 
          - 
            $ref: "#/components/schemas/ModuleDTO"
          - 
            type: "object"
            required: 
              - "levels"
            properties: 
              levels: 
                type: "array"
                items: 
                  $ref: "#/components/schemas/LevelWithProgressDTO"
      CreateModuleInput: 
        type: "object"
        required: 
          - "languageId"
          - "name"
        properties: 
          languageId: 
            type: "integer"
            description: "Language ID"
            example: 1
          name: 
            type: "string"
            description: "Module name"
            example: "Intermediate"
          icon: 
            type: "string"
            description: "Module icon (emoji or URL)"
            example: "üìñ"
      UpdateModuleInput: 
        type: "object"
        properties: 
          name: 
            type: "string"
            description: "Module name"
            example: "Advanced"
          icon: 
            type: "string"
            description: "Module icon (emoji or URL)"
            example: "üéì"
      CreateLevelInput: 
        type: "object"
        required: 
          - "moduleId"
          - "name"
          - "questsCount"
        properties: 
          moduleId: 
            type: "integer"
            description: "Module ID"
            example: 1
          name: 
            type: "string"
            description: "Level name"
            example: "Food and Drinks"
          questsCount: 
            type: "integer"
            description: "Number of quests in this level"
            example: 20
      UpdateLevelInput: 
        type: "object"
        properties: 
          name: 
            type: "string"
            description: "Level name"
            example: "Animals"
          questsCount: 
            type: "integer"
            description: "Number of quests in this level"
            example: 15
      UserLevelProgressDTO: 
        type: "object"
        required: 
          - "id"
          - "userId"
          - "levelId"
          - "questsCount"
          - "score"
          - "stars"
          - "exp"
        properties: 
          id: 
            type: "integer"
            description: "User level progress ID"
            example: 1
          userId: 
            type: "integer"
            description: "User ID"
            example: 1
          levelId: 
            type: "integer"
            description: "Level ID"
            example: 1
          questsCount: 
            type: "integer"
            description: "Number of quests completed"
            example: 5
          score: 
            type: "integer"
            description: "Number of correct answers"
            example: 4
          stars: 
            type: "integer"
            description: "Stars earned (equal to score)"
            example: 4
          exp: 
            type: "integer"
            description: "Experience earned (score / 100)"
            example: 0
      CurrentLevelDTO: 
        type: "object"
        required: 
          - "levelId"
          - "levelName"
          - "progress"
          - "questsCompleted"
          - "totalQuests"
        properties: 
          levelId: 
            type: "integer"
            description: "Current level ID"
            example: 2
          levelName: 
            type: "string"
            description: "Current level name"
            example: "Numbers"
          progress: 
            type: "number"
            description: "Progress percentage (0-100)"
            example: 33.33
          questsCompleted: 
            type: "integer"
            description: "Number of quests completed"
            example: 5
          totalQuests: 
            type: "integer"
            description: "Total number of quests in level"
            example: 15
      UserStatsDTO: 
        type: "object"
        required: 
          - "totalStars"
          - "totalExp"
          - "completedLevels"
        properties: 
          totalStars: 
            type: "integer"
            description: "Total stars earned across all levels"
            example: 15
          totalExp: 
            type: "integer"
            description: "Total experience earned"
            example: 0
          completedLevels: 
            type: "integer"
            description: "Number of completed levels"
            example: 1
          currentLevel: 
            $ref: "#/components/schemas/CurrentLevelDTO"
      SaveProgressInput: 
        type: "object"
        required: 
          - "levelId"
          - "questId"
          - "correct"
        properties: 
          levelId: 
            type: "integer"
            description: "Level ID"
            example: 1
          questId: 
            type: "integer"
            description: "Quest ID"
            example: 1
          correct: 
            type: "boolean"
            description: "Whether the answer was correct"
            example: true
      QuestMatchWordsDataDTO: 
        type: "object"
        required: 
          - "word"
          - "translate"
        properties: 
          word: 
            type: "string"
            description: "Word in foreign language"
            example: "hello"
          translate: 
            type: "string"
            description: "Translation of the word"
            example: "–ø—Ä–∏–≤–µ—Ç"
      WordDTO: 
        type: "object"
        required: 
          - "id"
          - "value"
          - "position"
        properties: 
          id: 
            type: "integer"
            description: "Word ID"
            example: 1
          value: 
            type: "string"
            description: "Word value"
            example: "How"
          position: 
            type: "integer"
            description: "Position in sentence"
            example: 0
      DistractorWordDTO: 
        type: "object"
        required: 
          - "id"
          - "value"
        properties: 
          id: 
            type: "integer"
            description: "Word ID"
            example: 4
          value: 
            type: "string"
            description: "Distractor word value"
            example: "is"
      SentenceDTO: 
        type: "object"
        required: 
          - "id"
          - "text"
          - "words"
        properties: 
          id: 
            type: "integer"
            description: "Sentence ID"
            example: 1
          text: 
            type: "string"
            description: "Full sentence text"
            example: "How are you"
          words: 
            type: "array"
            items: 
              $ref: "#/components/schemas/WordDTO"
      QuestDictationDataDTO: 
        type: "object"
        required: 
          - "correctSentence"
        properties: 
          audioMediaId: 
            type: "integer"
            description: "Audio media ID for playback"
            example: 1
          correctSentence: 
            $ref: "#/components/schemas/SentenceDTO"
          distractorWords: 
            type: "array"
            items: 
              $ref: "#/components/schemas/DistractorWordDTO"
      QuestTranslateDataDTO: 
        type: "object"
        required: 
          - "sourceSentence"
          - "correctSentence"
        properties: 
          sourceSentence: 
            type: "string"
            description: "Sentence to translate"
            example: "–ö–∞–∫ –¥–µ–ª–∞"
          correctSentence: 
            $ref: "#/components/schemas/SentenceDTO"
          distractorWords: 
            type: "array"
            items: 
              $ref: "#/components/schemas/DistractorWordDTO"
      QuestDTO: 
        type: "object"
        required: 
          - "id"
          - "type"
          - "levelId"
          - "data"
        properties: 
          id: 
            type: "integer"
            description: "Quest ID"
            example: 1
          type: 
            type: "string"
            enum: 
              - "match_words"
              - "dictation"
              - "translate"
            description: "Quest type"
            example: "match_words"
          levelId: 
            type: "integer"
            description: "Level ID this quest belongs to"
            example: 1
          data: 
            oneOf: 
              - 
                $ref: "#/components/schemas/QuestMatchWordsDataDTO"
              - 
                $ref: "#/components/schemas/QuestDictationDataDTO"
              - 
                $ref: "#/components/schemas/QuestTranslateDataDTO"
      CreateQuestMatchWordsInput: 
        type: "object"
        required: 
          - "type"
          - "levelId"
          - "word"
          - "translate"
        properties: 
          type: 
            type: "string"
            enum: 
              - "match_words"
            example: "match_words"
          levelId: 
            type: "integer"
            description: "Level ID"
            example: 1
          word: 
            type: "string"
            description: "Word in foreign language"
            example: "apple"
          translate: 
            type: "string"
            description: "Translation"
            example: "—è–±–ª–æ–∫–æ"
      CreateQuestDictationInput: 
        type: "object"
        required: 
          - "type"
          - "levelId"
          - "text"
          - "language"
        properties: 
          type: 
            type: "string"
            enum: 
              - "dictation"
            example: "dictation"
          levelId: 
            type: "integer"
            description: "Level ID"
            example: 1
          text: 
            type: "string"
            description: "Text to be dictated (audio will be generated)"
            example: "I like apples"
          language: 
            type: "string"
            description: "Language code for TTS"
            example: "en"
          distractorWords: 
            type: "array"
            items: 
              type: "string"
            description: "Additional words to confuse user"
            example: 
              - "oranges"
              - "bananas"
              - "grapes"
      CreateQuestTranslateInput: 
        type: "object"
        required: 
          - "type"
          - "levelId"
          - "sourceSentence"
          - "correctSentence"
          - "targetLanguage"
        properties: 
          type: 
            type: "string"
            enum: 
              - "translate"
            example: "translate"
          levelId: 
            type: "integer"
            description: "Level ID"
            example: 1
          sourceSentence: 
            type: "string"
            description: "Sentence to translate"
            example: "–Ø –ª—é–±–ª—é —è–±–ª–æ–∫–∏"
          correctSentence: 
            type: "string"
            description: "Correct translation"
            example: "I like apples"
          targetLanguage: 
            type: "string"
            description: "Target language code for TTS"
            example: "en"
          distractorWords: 
            type: "array"
            items: 
              type: "string"
            description: "Additional words to confuse user"
            example: 
              - "oranges"
              - "bananas"
      SubmitAnswerInput: 
        type: "object"
        required: 
          - "questId"
          - "answer"
        properties: 
          questId: 
            type: "integer"
            description: "Quest ID"
            example: 1
          answer: 
            oneOf: 
              - 
                type: "string"
                description: "Answer for match_words quest"
                example: "–ø—Ä–∏–≤–µ—Ç"
              - 
                type: "array"
                items: 
                  type: "string"
                description: "Array of words for dictation/translate quest"
                example: 
                  - "How"
                  - "are"
                  - "you"
      QuestResultDTO: 
        type: "object"
        required: 
          - "questId"
          - "correct"
        properties: 
          questId: 
            type: "integer"
            description: "Quest ID"
            example: 1
          correct: 
            type: "boolean"
            description: "Whether the answer was correct"
            example: true
          correctAnswer: 
            oneOf: 
              - 
                type: "string"
                description: "Correct answer for match_words"
                example: "–ø—Ä–∏–≤–µ—Ç"
              - 
                type: "array"
                items: 
                  type: "string"
                description: "Correct answer for dictation/translate"
                example: 
                  - "How"
                  - "are"
                  - "you"
      UserDTO: 
        type: "object"
        required: 
          - "id"
          - "externalId"
          - "username"
          - "stars"
          - "exp"
          - "role"
          - "createdAt"
        properties: 
          id: 
            type: "integer"
            description: "Internal user ID"
            example: 1
          externalId: 
            type: "integer"
            description: "External user ID from Telegram"
            example: 123456789
          username: 
            type: "string"
            description: "Username"
            example: "john_doe"
          firstName: 
            type: "string"
            description: "User's first name"
            example: "John"
          lastName: 
            type: "string"
            description: "User's last name"
            example: "Doe"
          photoUrl: 
            type: "string"
            description: "URL to user's photo"
            example: "https://example.com/photo.jpg"
          stars: 
            type: "integer"
            description: "Number of stars earned"
            example: 100
          exp: 
            type: "integer"
            description: "Experience points"
            example: 500
          role: 
            type: "string"
            enum: 
              - "user"
              - "admin"
            description: "User role"
            example: "user"
          languageId: 
            type: "integer"
            description: "Selected language ID"
            example: 1
          createdAt: 
            type: "string"
            format: "date-time"
            description: "Account creation date"
            example: "2024-01-01T00:00:00.000Z"
          lastLoginAt: 
            type: "string"
            format: "date-time"
            description: "Last login date"
            example: "2024-01-15T10:30:00.000Z"
    responses: 
      BadRequest: 
        description: "Bad request - Invalid input data"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 400
              type: "BAD_REQUEST"
              message: "Bad request."
      Unauthorized: 
        description: "Unauthorized - Invalid or missing authentication token"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 401
              type: "UNAUTHORIZED"
              message: "Unauthorized."
      Forbidden: 
        description: "Forbidden - Insufficient permissions"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 403
              type: "ADMIN_REQUIRED"
              message: "Admin access required."
      NotFound: 
        description: "Resource not found"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 404
              type: "NOT_FOUND"
              message: "Not found."
      LanguageNotFound: 
        description: "Language not found"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 404
              type: "LANGUAGE_NOT_FOUND"
              message: "Language not found."
      ModuleNotFound: 
        description: "Module not found"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 404
              type: "MODULE_NOT_FOUND"
              message: "Module not found."
      LevelNotFound: 
        description: "Level not found"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 404
              type: "LEVEL_NOT_FOUND"
              message: "Level not found."
      QuestNotFound: 
        description: "Quest not found"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 404
              type: "QUEST_NOT_FOUND"
              message: "Quest not found."
      UserNotFound: 
        description: "User not found"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 404
              type: "USER_NOT_FOUND"
              message: "User not found."
      InvalidAnswer: 
        description: "Invalid answer format"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 400
              type: "INVALID_ANSWER"
              message: "Invalid answer format."
      InternalServerError: 
        description: "Internal server error"
        content: 
          application/json: 
            schema: 
              $ref: "#/components/schemas/ErrorResponse"
            example: 
              code: 500
              type: "INTERNAL_SERVER_ERROR"
              message: "Internal server error."
  paths: 
    /api/auth: 
      post: 
        tags: 
          - "Authentication"
        summary: "Authenticate user via Telegram initData"
        description: "Authenticates a user using Telegram WebApp initData and returns access token. RefreshToken is set in httpOnly cookie."
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                required: 
                  - "initData"
                properties: 
                  initData: 
                    type: "string"
                    description: "Telegram WebApp initialization data"
                    example: "query_id=AAHdF6IQAAAAAN0XohDhrOrc&user=%7B%22id%22%3A279058397..."
        responses: 
          200: 
            description: "Successfully authenticated"
            headers: 
              Set-Cookie: 
                description: "HttpOnly cookie with refresh token"
                schema: 
                  type: "string"
                  example: "refreshToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...; Max-Age=2592000; Path=/; HttpOnly; Secure; SameSite=Strict"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/AuthResponseDTO"
          400: 
            description: "Bad request - initData is missing"
          401: 
            description: "Unauthorized - invalid initData"
    /api/auth/me: 
      get: 
        tags: 
          - "Authentication"
        summary: "Get current user profile"
        description: "Returns the profile of the currently authenticated user"
        security: 
          - 
            JWT: []
        responses: 
          200: 
            description: "User profile retrieved successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/UserDTO"
          401: 
            description: "Unauthorized - invalid or missing access token"
    /api/friends: 
      get: 
        tags: 
          - "Friends"
        summary: "Get list of friends"
        description: "Returns the list of all friends for the authenticated user"
        security: 
          - 
            JWT: []
        responses: 
          200: 
            description: "List of friends retrieved successfully"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    $ref: "#/components/schemas/FriendDTO"
          401: 
            description: "Unauthorized - invalid or missing access token"
    /api/friends/search: 
      get: 
        tags: 
          - "Friends"
        summary: "Search for users"
        description: "Search for users by username (excluding current user and existing friends)"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "query"
            name: "query"
            required: true
            schema: 
              type: "string"
            description: "Search query for username"
          - 
            in: "query"
            name: "limit"
            required: false
            schema: 
              type: "integer"
              default: 20
            description: "Maximum number of results to return"
        responses: 
          200: 
            description: "Search results retrieved successfully"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    $ref: "#/components/schemas/UserShortDTO"
          400: 
            description: "Bad request - missing or invalid query parameter"
          401: 
            description: "Unauthorized - invalid or missing access token"
    /api/friends/requests/incoming: 
      get: 
        tags: 
          - "Friends"
        summary: "Get incoming friend requests"
        description: "Returns all pending friend requests received by the authenticated user"
        security: 
          - 
            JWT: []
        responses: 
          200: 
            description: "Incoming friend requests retrieved successfully"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    $ref: "#/components/schemas/FriendRequestDTO"
          401: 
            description: "Unauthorized - invalid or missing access token"
    /api/friends/requests/outgoing: 
      get: 
        tags: 
          - "Friends"
        summary: "Get outgoing friend requests"
        description: "Returns all pending friend requests sent by the authenticated user"
        security: 
          - 
            JWT: []
        responses: 
          200: 
            description: "Outgoing friend requests retrieved successfully"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    $ref: "#/components/schemas/FriendRequestDTO"
          401: 
            description: "Unauthorized - invalid or missing access token"
    /api/friends/requests: 
      post: 
        tags: 
          - "Friends"
        summary: "Send a friend request"
        description: "Sends a friend request to another user"
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/SendFriendRequestInput"
        responses: 
          201: 
            description: "Friend request sent successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/FriendRequestDTO"
          400: 
            description: "Bad request - invalid input or friend request already exists"
          401: 
            description: "Unauthorized - invalid or missing access token"
          404: 
            description: "User not found"
    /api/friends/requests/{requestId}/respond: 
      post: 
        tags: 
          - "Friends"
        summary: "Respond to a friend request"
        description: "Accept or reject a friend request"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "requestId"
            required: true
            schema: 
              type: "integer"
            description: "ID of the friend request"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/RespondToFriendRequestInput"
        responses: 
          200: 
            description: "Friend request responded to successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/FriendRequestDTO"
          400: 
            description: "Bad request - invalid input or request already responded"
          401: 
            description: "Unauthorized - invalid or missing access token"
          403: 
            description: "Forbidden - you are not the recipient of this request"
          404: 
            description: "Friend request not found"
    /api/friends/requests/{requestId}/cancel: 
      delete: 
        tags: 
          - "Friends"
        summary: "Cancel a friend request"
        description: "Cancel a pending friend request that you sent"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "requestId"
            required: true
            schema: 
              type: "integer"
            description: "ID of the friend request to cancel"
        responses: 
          200: 
            description: "Friend request canceled successfully"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    message: 
                      type: "string"
                      example: "Friend request canceled"
          400: 
            description: "Bad request - request already responded"
          401: 
            description: "Unauthorized - invalid or missing access token"
          403: 
            description: "Forbidden - you did not send this request"
          404: 
            description: "Friend request not found"
    /api/friends/{friendId}: 
      delete: 
        tags: 
          - "Friends"
        summary: "Remove a friend"
        description: "Remove a user from your friends list"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "friendId"
            required: true
            schema: 
              type: "integer"
            description: "ID of the friend to remove"
        responses: 
          200: 
            description: "Friend removed successfully"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    message: 
                      type: "string"
                      example: "Friend removed"
          401: 
            description: "Unauthorized - invalid or missing access token"
          404: 
            description: "Friendship not found"
    /api/languages: 
      get: 
        tags: 
          - "Languages"
        summary: "Get all languages"
        description: "Returns a list of all available languages for learning"
        responses: 
          200: 
            description: "List of languages"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    $ref: "#/components/schemas/LanguageDTO"
      post: 
        tags: 
          - "Languages"
          - "Admin"
        summary: "Create a new language (Admin only)"
        description: "Creates a new language for learning. Requires admin privileges."
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/CreateLanguageInput"
        responses: 
          201: 
            description: "Language created successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LanguageDTO"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
    /api/languages/{id}: 
      get: 
        tags: 
          - "Languages"
        summary: "Get language by ID"
        description: "Returns a specific language by its ID"
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Language ID"
        responses: 
          200: 
            description: "Language data"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LanguageDTO"
          404: 
            description: "Language not found"
      put: 
        tags: 
          - "Languages"
          - "Admin"
        summary: "Update a language (Admin only)"
        description: "Updates an existing language. Requires admin privileges."
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Language ID"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/UpdateLanguageInput"
        responses: 
          200: 
            description: "Language updated successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LanguageDTO"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Language not found"
      delete: 
        tags: 
          - "Languages"
          - "Admin"
        summary: "Delete a language (Admin only)"
        description: "Deletes a language. Requires admin privileges."
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Language ID"
        responses: 
          204: 
            description: "Language deleted successfully"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Language not found"
    /api/languages/user/set: 
      put: 
        tags: 
          - "Languages"
        summary: "Set user's learning language"
        description: "Sets the language that the user wants to learn"
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/SetUserLanguageInput"
        responses: 
          200: 
            description: "Language set successfully"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    message: 
                      type: "string"
                      example: "Language set successfully"
          401: 
            description: "Unauthorized"
          404: 
            description: "Language not found"
    /api/languages/user/current: 
      get: 
        tags: 
          - "Languages"
        summary: "Get user's current learning language"
        description: "Returns the language currently selected by the user for learning"
        security: 
          - 
            JWT: []
        responses: 
          200: 
            description: "Current user language"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LanguageDTO"
          401: 
            description: "Unauthorized"
    /api/levels/{id}: 
      get: 
        tags: 
          - "Levels"
        summary: "Get level by ID"
        description: "Returns a specific level by its ID"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Level ID"
        responses: 
          200: 
            description: "Level data"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LevelDTO"
          401: 
            description: "Unauthorized"
          404: 
            description: "Level not found"
      put: 
        tags: 
          - "Levels"
          - "Admin"
        summary: "Update a level (Admin only)"
        description: "Updates an existing level. Requires admin privileges."
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Level ID"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/UpdateLevelInput"
        responses: 
          200: 
            description: "Level updated successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LevelDTO"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Level not found"
      delete: 
        tags: 
          - "Levels"
          - "Admin"
        summary: "Delete a level (Admin only)"
        description: "Deletes a level and all its quests. Requires admin privileges."
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Level ID"
        responses: 
          204: 
            description: "Level deleted successfully"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Level not found"
    /api/levels: 
      post: 
        tags: 
          - "Levels"
          - "Admin"
        summary: "Create a new level (Admin only)"
        description: "Creates a new level in a module. Requires admin privileges."
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/CreateLevelInput"
        responses: 
          201: 
            description: "Level created successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LevelDTO"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Module not found"
    /api/modules/{languageId}: 
      get: 
        tags: 
          - "Modules"
        summary: "Get modules by language"
        description: "Returns all modules for a specific language with levels and user progress"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "languageId"
            required: true
            schema: 
              type: "integer"
            description: "Language ID"
        responses: 
          200: 
            description: "List of modules with levels and progress"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    $ref: "#/components/schemas/ModuleWithLevelsDTO"
          401: 
            description: "Unauthorized"
          404: 
            description: "Language not found"
    /api/modules/single/{id}: 
      get: 
        tags: 
          - "Modules"
        summary: "Get module by ID"
        description: "Returns a specific module by its ID"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Module ID"
        responses: 
          200: 
            description: "Module data"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/ModuleDTO"
          401: 
            description: "Unauthorized"
          404: 
            description: "Module not found"
    /api/modules: 
      post: 
        tags: 
          - "Modules"
          - "Admin"
        summary: "Create a new module (Admin only)"
        description: "Creates a new learning module for a language. Requires admin privileges."
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/CreateModuleInput"
        responses: 
          201: 
            description: "Module created successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/ModuleDTO"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Language not found"
    /api/modules/{id}: 
      put: 
        tags: 
          - "Modules"
          - "Admin"
        summary: "Update a module (Admin only)"
        description: "Updates an existing module. Requires admin privileges."
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Module ID"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/UpdateModuleInput"
        responses: 
          200: 
            description: "Module updated successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/ModuleDTO"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Module not found"
      delete: 
        tags: 
          - "Modules"
          - "Admin"
        summary: "Delete a module (Admin only)"
        description: "Deletes a module and all its levels. Requires admin privileges."
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Module ID"
        responses: 
          204: 
            description: "Module deleted successfully"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Module not found"
    /api/progress/save: 
      post: 
        tags: 
          - "Progress"
        summary: "Save user progress"
        description: "Saves progress after completing a quest. Updates user's level progress and overall statistics.\n\nStars are equal to the score (number of correct answers).\nExperience is calculated as score / 100.\n"
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/SaveProgressInput"
        responses: 
          200: 
            description: "Progress saved successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/UserLevelProgressDTO"
          401: 
            description: "Unauthorized"
          404: 
            description: "Level or user not found"
    /api/progress/stats: 
      get: 
        tags: 
          - "Progress"
        summary: "Get user statistics"
        description: "Returns comprehensive user statistics including total stars, experience, \ncompleted levels count, and current level progress.\n"
        security: 
          - 
            JWT: []
        responses: 
          200: 
            description: "User statistics"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/UserStatsDTO"
          401: 
            description: "Unauthorized"
          404: 
            description: "User not found"
    /api/progress/level/{levelId}: 
      get: 
        tags: 
          - "Progress"
        summary: "Get progress for a specific level"
        description: "Returns user's progress on a specific level"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "levelId"
            required: true
            schema: 
              type: "integer"
            description: "Level ID"
        responses: 
          200: 
            description: "Level progress data (null if not started)"
            content: 
              application/json: 
                schema: 
                  oneOf: 
                    - 
                      $ref: "#/components/schemas/UserLevelProgressDTO"
                    - 
                      type: "null"
          401: 
            description: "Unauthorized"
    /api/quests/level/{levelId}: 
      get: 
        tags: 
          - "Quests"
        summary: "Get quests by level"
        description: "Returns all quests for a specific level"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "levelId"
            required: true
            schema: 
              type: "integer"
            description: "Level ID"
        responses: 
          200: 
            description: "List of quests"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    $ref: "#/components/schemas/QuestDTO"
          401: 
            description: "Unauthorized"
          404: 
            description: "Level not found"
    /api/quests/{id}: 
      get: 
        tags: 
          - "Quests"
        summary: "Get quest by ID"
        description: "Returns a specific quest by its ID with all data"
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Quest ID"
        responses: 
          200: 
            description: "Quest data"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/QuestDTO"
          401: 
            description: "Unauthorized"
          404: 
            description: "Quest not found"
      delete: 
        tags: 
          - "Quests"
          - "Admin"
        summary: "Delete a quest (Admin only)"
        description: "Deletes a quest and all related data. Requires admin privileges."
        security: 
          - 
            JWT: []
        parameters: 
          - 
            in: "path"
            name: "id"
            required: true
            schema: 
              type: "integer"
            description: "Quest ID"
        responses: 
          204: 
            description: "Quest deleted successfully"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Quest not found"
    /api/quests/submit: 
      post: 
        tags: 
          - "Quests"
        summary: "Submit answer to a quest"
        description: "Submits user's answer and checks if it's correct"
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                $ref: "#/components/schemas/SubmitAnswerInput"
        responses: 
          200: 
            description: "Answer checked successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/QuestResultDTO"
          400: 
            description: "Invalid answer format"
          401: 
            description: "Unauthorized"
          404: 
            description: "Quest not found"
    /api/quests: 
      post: 
        tags: 
          - "Quests"
          - "Admin"
        summary: "Create a new quest (Admin only)"
        description: "Creates a new quest of any type. Requires admin privileges.\n\nFor dictation and translate quests, audio files are automatically generated using TTS and saved to /media folder.\n"
        security: 
          - 
            JWT: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                oneOf: 
                  - 
                    $ref: "#/components/schemas/CreateQuestMatchWordsInput"
                  - 
                    $ref: "#/components/schemas/CreateQuestDictationInput"
                  - 
                    $ref: "#/components/schemas/CreateQuestTranslateInput"
              examples: 
                match_words: 
                  summary: "Match Words Quest"
                  value: 
                    type: "match_words"
                    levelId: 1
                    word: "apple"
                    translate: "—è–±–ª–æ–∫–æ"
                dictation: 
                  summary: "Dictation Quest"
                  value: 
                    type: "dictation"
                    levelId: 1
                    text: "I like apples"
                    language: "en"
                    distractorWords: 
                      - "oranges"
                      - "bananas"
                      - "grapes"
                translate: 
                  summary: "Translate Quest"
                  value: 
                    type: "translate"
                    levelId: 1
                    sourceSentence: "–Ø –ª—é–±–ª—é —è–±–ª–æ–∫–∏"
                    correctSentence: "I like apples"
                    targetLanguage: "en"
                    distractorWords: 
                      - "oranges"
                      - "bananas"
        responses: 
          201: 
            description: "Quest created successfully"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/QuestDTO"
          400: 
            description: "Invalid request data"
          401: 
            description: "Unauthorized"
          403: 
            description: "Admin access required"
          404: 
            description: "Level not found"
  tags: 
    - 
      name: "Authentication"
      description: "User authentication and authorization"
    - 
      name: "Languages"
      description: "Language management and selection"
    - 
      name: "Modules"
      description: "Learning modules management"
    - 
      name: "Levels"
      description: "Level management within modules"
    - 
      name: "Quests"
      description: "Quest (task) management and submission"
    - 
      name: "Progress"
      description: "User progress tracking and statistics"
    - 
      name: "Admin"
      description: "Administrative operations (requires admin role)"
    - 
      name: "Friends"
      description: "Friend management and social features"
